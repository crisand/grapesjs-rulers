/*! grapesjs-rulers - 1.0.19 */
!function(e,t){'object'==typeof exports&&'object'==typeof module?module.exports=t():'function'==typeof define&&define.amd?define([],t):'object'==typeof exports?exports["grapesjs-rulers"]=t():e["grapesjs-rulers"]=t()}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){'undefined'!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:'Module'}),Object.defineProperty(e,'__esModule',{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&'object'==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,'default',{enumerable:!0,value:e}),2&t&&'string'!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e['default']}:function(){return e};return n.d(t,'a',t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=1)}([function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";n.r(t);var r=n(0),o=n.n(r),i=function(e){this.api=this.builder(),this.api.constructRulers.call(this,e)};function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}i.prototype.builder=function(){var e,t=1,n=2,r=0,o=0,s=0,l=0,a=1,u={},c=[],p=document.createElement('div'),d=[],f={rulerHeight:15,fontFamily:'arial',fontSize:'11px',strokeStyle:'gray',sides:['top','left'],cornerSides:['TL'],lineWidth:1,enableMouseTracking:!0,enableToolTip:!0},y=function(e,t){switch(e.canvas.style.left="0px",t){case'top':e.orgPos=parseInt(e.canvas.style.left);break;case'left':e.canvas.style.top=i.prototype.utils.pixelize(-e.canvas.height-1),e.orgPos=parseInt(e.canvas.style.top),function(e,t){var n='rotate('+t+'deg)',r=i.prototype.utils.pixelize(Math.abs(parseInt(e.canvas.style.left)))+' 100%';e.canvas.style.webkitTransform=n,e.canvas.style.MozTransform=n,e.canvas.style.OTransform=n,e.canvas.style.msTransform=n,e.canvas.style.transform=n,e.canvas.style.webkitTransformOrigin=r,e.canvas.style.MozTransformOrigin=r,e.canvas.style.OTransformOrigin=r,e.canvas.style.msTransformOrigin=r,e.canvas.style.transformOrigin=r}(e,90)}},g=function(n,u,d,f,y){var g,v=document.createElement('div'),h=n===t?'rul_lineVer':'rul_lineHor',m=n===t?r:o;v.title='Double click to delete',i.prototype.utils.addClasss(v,['rul_line',h]),v=p.appendChild(v),n===t?(v.style.left=i.prototype.utils.pixelize(u-e.container.getBoundingClientRect().left),y&&(v.style.left=i.prototype.utils.pixelize(Math.round(u/a+e.rulerHeight-s)))):(v.style.top=i.prototype.utils.pixelize(d-e.container.getBoundingClientRect().top),y&&(v.style.top=i.prototype.utils.pixelize(Math.round(d/a+e.rulerHeight-l)))),c.push({dimension:n,line:i.prototype.guideLine(v,e.container.querySelector('.rul_wrapper'),n,e,m,(function(n,r,o){var i=n.dimension===t?r:o;n.assigned()?i<e.rulerHeight&&(c.some((function(e,t){if(e.line===n)return g=t,!0})),n.destroy(),c.splice(g,1)):i>e.rulerHeight&&n.assigned(!0)}),f,a)})},v=function(r,o){var s,l,a,c='left'===o||'right'===o?t:n,p=c===t?'rul_ruler_Vertical':'rul_ruler_Horizontal',d=document.createElement('canvas');i.prototype.utils.addClasss(d,['rul_ruler',p,'rul_align_'+o]),s=r.appendChild(d),u[o]=i.prototype.rulerConstructor(s,e,c),u[o].drawRuler(4e3,e.rulerHeight),y(u[o],o),l=u[o],a=function(e){g(l.dimension,e.clientX,e.clientY,e)},l.canvas.addEventListener('mousedown',a),l.clearListeners=function(){l.canvas.removeEventListener('mousedown',a)}},h=function(){function t(e){e.stopPropagation(),x()}return function(n,r){r.forEach((function(r){var o=function(t,n){var r=document.createElement('div'),o='rul_corner'+n.toUpperCase();return r.title='Clear Guide lines',i.prototype.utils.addClasss(r,['rul_corner',o]),r.style.width=i.prototype.utils.pixelize(e.rulerHeight+1),r.style.height=i.prototype.utils.pixelize(e.rulerHeight),t.appendChild(r)}(n,r);o.addEventListener('mousedown',t),o.destroy=function(){o.removeEventListener('mousedown',t),o.parentNode.removeChild(o)},d.push(o)}))}}(),m=function(e){c.forEach((function(e){e.line.stopDrag()}))},b=function(e){var t=0;for(var n in u)u.hasOwnProperty(n)&&e(u[n],t++)},x=function(){c.forEach((function(e){e.line.destroy()})),c=[]};return{VERTICAL:t,HORIZONTAL:n,getPos:function(){return{x:r,y:o}},setPos:function(e){var s,l=0,a=0,u=0;b((function(n){n.dimension===t?(s=n.canvas.style.top,n.canvas.style.top=i.prototype.utils.pixelize(n.orgPos+parseInt(e.y)),u=parseInt(s)-parseInt(n.canvas.style.top)):(l=n.canvas.style.left,n.canvas.style.left=i.prototype.utils.pixelize(n.orgPos+parseInt(e.x)),a=parseInt(l)-parseInt(n.canvas.style.left))})),c.forEach((function(t){t.dimension===n?(t.line.guideLine.style.top=i.prototype.utils.pixelize(parseInt(t.line.guideLine.style.top)-u),t.line.curPosDelta(parseInt(e.y))):(t.line.guideLine.style.left=i.prototype.utils.pixelize(parseInt(t.line.guideLine.style.left)-a),t.line.curPosDelta(parseInt(e.x)))})),r=parseInt(e.x),o=parseInt(e.y)},setScroll:function(e){s=e.x,l=e.y},setScale:function(t){var s,l,u;b((function(e){e.context.clearRect(0,0,e.canvas.width,e.canvas.height),e.context.beginPath(),e.setScale(t),e.context.stroke(),a=t})),c.forEach((function(a){a.dimension===n?(s=parseInt(a.line.guideLine.style.top),l=e.rulerHeight+1,u=parseFloat(t)/a.line.curScale(),a.line.guideLine.style.top=i.prototype.utils.pixelize((s-l-o)/u+l+o),a.line.curScale(t)):(s=parseInt(a.line.guideLine.style.left),l=e.rulerHeight+1,u=parseFloat(t)/a.line.curScale(),a.line.guideLine.style.left=i.prototype.utils.pixelize((s-l-r)/u+l+r),a.line.curScale(t))}))},clearGuides:x,getGuides:function(){return c.map((function(t){return{posX:Math.round((parseInt(t.line.guideLine.style.left)-e.rulerHeight+s)*a),posY:Math.round((parseInt(t.line.guideLine.style.top)-e.rulerHeight+l)*a),dimension:t.dimension}}))},setGuides:function(e){e&&e.length&&e.forEach((function(e){g(e.dimension,e.posX,e.posY,null,!0)}))},constructRulers:function(t){p=i.prototype.utils.addClasss(p,'rul_wrapper'),e=i.prototype.utils.extend(f,t),p=e.container.appendChild(p),e.sides.forEach((function(e){v(p,e)})),h(p,e.cornerSides),e.container.addEventListener('mouseup',m)},toggleRulerVisibility:function(t){var n=t?'block':'none';p.style.display=n;var r=e.container.querySelectorAll('.rul_tracker');r.length>0&&(r[0].style.display=n,r[1].style.display=n)},toggleGuideVisibility:function(e){var t=e?'show':'hide';c.forEach((function(e){e.line[t]()}))},destroy:function(){x(),b((function(e){e.destroy()})),d.forEach((function(e){e.destroy()})),e.container.removeEventListener('mouseup',m),p.parentNode.removeChild(p)}}},i.prototype.rulerConstructor=function(e,t,n){var r=e,o=r.getContext('2d'),s=0,l=0,a=1,u=n||2,c=document.createElement('div'),p=function(){for(var e=0,t='',n=0,r=!1,i=100/a,u=0,c=s/3,p=s/2,d=0;d<=l;d++){n=d,r=!1,t='';Math.abs(d);n%96==0?(e=u,t=n/96,r=!0):n%48==0?(e=c,r=!0):n%24==0&&(e=p,r=!0),r&&(o.moveTo(d*(i/100),s+.5),o.lineTo(d*(i/100),e+.5),o.fillText(t,d*(i/100)+2,s/2+1))}},d=function(e){var n=e.clientX,r=e.clientY;2===u?c.style.left=i.prototype.utils.pixelize(n-parseInt(t.container.getBoundingClientRect().left)):c.style.top=i.prototype.utils.pixelize(r-parseInt(t.container.getBoundingClientRect().top))};return t.enableMouseTracking&&function(){c=t.container.appendChild(c),i.prototype.utils.addClasss(c,'rul_tracker');var e=i.prototype.utils.pixelize(t.rulerHeight);2===u?c.style.height=e:c.style.width=e,t.container.addEventListener('mousemove',d)}(),{getLength:function(){return l},getThickness:function(){return s},getScale:function(){return a},setScale:function(e){return a=parseFloat(e),100*e,p(),a},dimension:u,orgPos:0,canvas:r,context:o,drawRuler:function(e,n,i){l=r.width=4*e,s=r.height=n,a=i||a,o.strokeStyle="#000000",o.fillStyle="#000000",o.font=t.fontSize+' '+t.fontFamily,o.lineWidth=t.lineWidth,o.beginPath(),p(),o.stroke()},drawPoints:p,destroy:function(){t.container.removeEventListener('mousemove',d),c.parentNode.removeChild(c),this.clearListeners&&this.clearListeners()}}},i.prototype.guideLine=function(e,t,n,r,o,s,l,a){var u,c=e,p=a||1,d=!1,f=o||0,y=t,g=n||2,v=s||function(){},h={cv:function(){return document.querySelector('.gjs-frame-wrapper')},move:function(e,t){c.style.left=i.prototype.utils.pixelize(e),c.style.top=i.prototype.utils.pixelize(t),b(e,t),v(u,e,t)},startMoving:function(e){this.cv().style.pointerEvents='none',i.prototype.utils.addClasss(c,['rul_line_dragged']);var t=(e=e||window.event)?e.clientX:0,n=e?e.clientY:0,o=parseInt(c.style.top||0),s=parseInt(c.style.left||0),l=parseInt(c.offsetWidth),a=parseInt(c.offsetHeight),u=parseInt(y.offsetWidth),p=parseInt(y.offsetHeight),d=2===g?'ns-resize':'ew-resize';r.container.style.cursor=d,c.style.cursor=d;var f=t-s,v=n-o;document.onmousemove=function(e){var t=(e=e||window.event).clientX,n=e.clientY,r=t-f,o=n-v;r<0&&(r=0),o<0&&(o=0),r+l>u&&(r=u-l),o+a>p&&(o=p-a),h.move(r,o)},m()},stopMoving:function(){h.cv().style.pointerEvents='all',r.container.style.cursor=null,c.style.cursor=null,document.onmousemove=function(){},x(),i.prototype.utils.removeClasss(c,['rul_line_dragged'])}},m=function(e){r.enableToolTip&&i.prototype.utils.addClasss(c,'rul_tooltip')},b=function(e,t){c.dataset.tip=t?Math.round((t-r.rulerHeight-1-f)*p)+'px':Math.round((e-r.rulerHeight-1-f)*p)+'px'},x=function(e){i.prototype.utils.removeClasss(c,'rul_tooltip')},w=function(){h.stopMoving(),v=null,c.removeEventListener('mousedown',C),c.removeEventListener('mouseup',O),c.removeEventListener('dblclick',E),c.parentNode&&c.parentNode.removeChild(c)},C=function(e){e.stopPropagation(),h.startMoving()},O=function(e){h.stopMoving()},E=function(e){e.stopPropagation(),w()};return c.addEventListener('mousedown',C),c.addEventListener('mouseup',O),c.addEventListener('dblclick',E),l&&h.startMoving(l),u={setAsDraggable:h,startDrag:h.startMoving,stopDrag:h.stopMoving,destroy:w,curScale:function(e){return void 0===e?p:p=e},assigned:function(e){return void 0===e?d:d=e},curPosDelta:function(e){return void 0===e?f:f=e},guideLine:c,dimension:g,hide:function(){c.style.display='none'},show:function(){c.style.display='block'}}},i.prototype.utils={extend:function(){for(var e=1;e<arguments.length;e++)for(var t in arguments[e])arguments[e].hasOwnProperty(t)&&(arguments[0][t]=arguments[e][t]);return arguments[0]},pixelize:function(e){return e+'px'},prependChild:function(e,t){return e.insertBefore(t,e.firstChild)},addClasss:function(e,t){return t instanceof Array||(t=[t]),t.forEach((function(t){e.className+=' '+t})),e},removeClasss:function(e,t){var n=e.className;return t instanceof Array||(t=[t]),t.forEach((function(e){n=n.replace(e,'')})),e.className=n,e}};t["default"]=function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=l(l({},{dragMode:'translate',rulerHeight:15,canvasZoom:94,rulerOpts:{}}),n),o=e.Commands,s=r.rulerHeight,a=r.canvasZoom,u=100/a;o.add('ruler-visibility',{run:function(e){!t&&(t=new i(l({container:e.Canvas.getCanvasView().el,rulerHeight:s,strokeStyle:'white',fillStyle:'white'},r.rulerOpts)))&&e.on('canvasScroll frame:scroll change:canvasOffset',(function(){c()})),e.Rulers=t,t.api.toggleRulerVisibility(!0),e.Canvas.setZoom(a),e.setDragMode(r.dragMode),c(),t.api.setScale(u)},stop:function(e){t&&t.api.toggleRulerVisibility(!1),e.Canvas.setZoom(100),e.setDragMode('')}});var c=function(){var n=e.Canvas.getOffset(),r=n.top,o=n.left,i=e.Canvas.getBody().scrollLeft,l=e.Canvas.getBody().scrollTop;t.api.setPos({x:o-s-i/u,y:r-s-l/u}),t.api.setScroll({x:i,y:l})};o.add('guides-visibility',{run:function(){t&&t.api.toggleGuideVisibility(!0)},stop:function(){t&&t.api.toggleGuideVisibility(!1)}}),o.add('clear-guides',(function(){t&&t.api.clearGuides()})),o.add('get-guides',(function(){return t?t.api.getGuides():0})),o.add('set-guides',(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};t&&r.guides&&t.api.setGuides(r.guides)})),o.add('set-zoom',(function(e,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};a=r.zoom,u=100/a,e.Canvas.setZoom(a),c(),t&&t.api.setScale(u)})),o.add('destroy-ruler',(function(){t&&t.api.destroy()}))}}])}));
//# sourceMappingURL=grapesjs-rulers.min.js.map